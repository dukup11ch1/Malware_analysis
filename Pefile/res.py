import datetime
class Res:
    def __init__(self,fpath,hash_,comp_time, section_Entropy, imp_Hash, MLV, codesize):
        self.fpath=fpath
        self.fname=fpath.split('\\')[-1]
        self.hash=hash_
        self.comp_time=datetime.datetime.fromtimestamp(comp_time)
        self.section_Entropy=section_Entropy
        self.imp_Hash=imp_Hash
        self.MLV=MLV
        self.codesize=codesize
        

    
    def print_result(self):
        import csv
        try:
            fp=open('result.csv','rb')
            fp.close()
            fp=open('result.csv','ab')
            wr=csv.writer(fp)
            
        
        except:
            fp=open('result.csv','wb')
            wr=csv.writer(fp)
            wr.writerow(["Filename","md5","comp Time","section1","section2","section3","section4","section5","section6","section7","section8","section9","Imphash","MajorLinkerVersion","SizeofCode"])
        
        section_Ent=[0,0,0,0,0]
        for i in range(9):
            try:
                section_Ent[i]=self.section_Entropy[i].entropy
            except:
                section_Ent[i]=None
        result=[self.fname,self.hash,str(self.comp_time),str(section_Ent[0]),str(section_Ent[1]),str(section_Ent[2]),str(section_Ent[3]),str(section_Ent[4]),self.imp_Hash,str(self.MLV),str(self.codesize)]
        wr.writerow(result)
        fp.close()
